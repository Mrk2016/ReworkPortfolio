---
// src/layouts/ProjectLayout.astro
import Footer from "../components/sections/Footer.astro";
import "../styles/global.css";
export interface Props {
  title: string;
  description: string;
  image: string;
  category: string;
  status: string;
  duration: string;
  demoUrl?: string;
  githubUrl: string;
  features: string[];
  challenges?: string[];
  solutions?: string[];
  gallery?: string[];
  // Ahora no pasamos las tecnologías por props, las definimos en el slot
}

const {
  title,
  description,
  image,
  category,
  status,
  duration,
  demoUrl,
  githubUrl,
  features,
  challenges = [],
  solutions = [],
  gallery = [],
} = Astro.props;
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} - Proyecto Detalle |</title>
    <meta name="description" content={description} />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/icon.ico" />

    <!-- Open Graph -->
    <meta property="og:title" content={`${title} - Proyecto Detalle`} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={image} />
    <meta property="og:type" content="website" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body class="bg-gradient-animated">
    <main class="pt-20">
      <!-- Hero Section -->
      <section class="px-[5%] py-16 max-w-7xl mx-auto">
        <!-- Breadcrumb -->
        <nav class="mb-8">
          <div class="flex items-center gap-3 text-sm text-gray-400">
            <a
              href="/"
              class="hover:text-green-400 transition-colors duration-300 no-underline"
              >Inicio</a
            >
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path>
            </svg>
            <a
              href="/#projects"
              class="hover:text-green-400 transition-colors duration-300 no-underline"
              >Proyectos</a
            >
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path>
            </svg>
            <span class="text-green-400">{title}</span>
          </div>
        </nav>

        <!-- Project Header -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-16">
          <!-- Project Info -->
          <div>
            <!-- Meta info -->
            <div class="flex flex-wrap items-center gap-4 mb-6">
              <span
                class="bg-green-500/10 text-green-500 px-4 py-2 rounded-full text-sm font-medium border border-green-500/20"
              >
                {category}
              </span>
              <span
                class={`px-4 py-2 rounded-full text-sm font-bold border backdrop-blur-sm ${
                  status === "Completado"
                    ? "bg-green-500/90 text-white border-green-500/30"
                    : "bg-yellow-500/90 text-white border-yellow-500/30"
                }`}
              >
                {status}
              </span>
              <span class="text-gray-400 text-sm flex items-center gap-2">
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                {duration}
              </span>
            </div>

            <!-- Title and description -->
            <h1 class="text-5xl font-bold text-gradient mb-6">
              {title}
            </h1>
            <p class="text-xl text-gray-300 leading-relaxed mb-8">
              {description}
            </p>

            <!-- Action buttons -->
            <div class="flex gap-4 flex-wrap">
              {
                demoUrl && (
                  <a
                    href={demoUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="btn-hover px-8 py-4 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg font-semibold no-underline inline-flex items-center gap-2 shadow-lg shadow-green-500/20"
                  >
                    <svg
                      class="w-5 h-5"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                      />
                    </svg>
                    Ver Demo Live
                  </a>
                )
              }
              <a
                href="/#projects"
                class="btn-hover px-8 py-4 bg-gray-800/50 text-white border border-white/10 hover:border-green-500/30 rounded-lg font-semibold no-underline inline-flex items-center gap-2 hover:bg-green-500/10"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Volver a Proyectos
              </a>
            </div>
          </div>

          <!-- Project Image -->
          <div class="glass rounded-3xl overflow-hidden border border-white/10">
            <img
              src={image}
              alt={title}
              class="w-full h-96 object-cover"
              onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjM4NCIgdmlld0JveD0iMCAwIDUwMCAzODQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI1MDAiIGhlaWdodD0iMzg0IiBmaWxsPSIjMUYyOTM3Ii8+CjxwYXRoIGQ9Ik0yNDUgMTYwTDI2MCAyMDEuNUwyNDUgMjQzTDIzMCAyMDEuNUwyNDUgMTYwWiIgZmlsbD0iIzM0Qzc1OSIvPgo8dGV4dCB4PSIyNTAiIHk9IjI2MCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiNBNEE0QTciIHRleHQtYW5jaG9yPSJtaWRkbGUiPkltYWdlbiBkZWwgcHJveWVjdG88L3RleHQ+Cjwvc3ZnPg=='"
            />
          </div>
        </div>
      </section>

      <!-- Technologies Section - Ahora es un slot nombrado -->
      <section class="px-[5%] py-16 max-w-7xl mx-auto">
        <h2 class="text-3xl font-bold text-white mb-8 text-center">
          Tecnologías Utilizadas
        </h2>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
          <slot name="technologies" />
        </div>
      </section>

      <!-- Main Content -->
      <section class="px-[5%] max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
          <!-- Content Area -->
          <div class="lg:col-span-2 space-y-12">
            <!-- Features Section -->
            {
              features.length > 0 && (
                <div class="glass rounded-3xl p-8 border border-white/10">
                  <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                    <svg
                      class="w-6 h-6 text-green-500"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                      />
                    </svg>
                    Características Principales
                  </h2>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {features.map((feature) => (
                      <div class="flex items-start gap-3 p-4 bg-green-500/5 rounded-xl border border-green-500/10">
                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0" />
                        <span class="text-gray-300">{feature}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )
            }

            <!-- Challenges & Solutions -->
            {
              (challenges.length > 0 || solutions.length > 0) && (
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                  {challenges.length > 0 && (
                    <div class="glass rounded-3xl p-8 border border-white/10">
                      <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-3">
                        <svg
                          class="w-5 h-5 text-yellow-500"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                          />
                        </svg>
                        Desafíos
                      </h3>
                      <ul class="space-y-3">
                        {challenges.map((challenge) => (
                          <li class="flex items-start gap-3">
                            <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0" />
                            <span class="text-gray-300">{challenge}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  )}

                  {solutions.length > 0 && (
                    <div class="glass rounded-3xl p-8 border border-white/10">
                      <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-3">
                        <svg
                          class="w-5 h-5 text-green-500"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                          />
                        </svg>
                        Soluciones
                      </h3>
                      <ul class="space-y-3">
                        {solutions.map((solution) => (
                          <li class="flex items-start gap-3">
                            <div class="w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0" />
                            <span class="text-gray-300">{solution}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  )}
                </div>
              )
            }

            <!-- Project Content Slot -->
            <div class="glass rounded-3xl p-8 border border-white/10">
              <slot />
            </div>
          </div>

          <!-- Sidebar -->
          <div class="space-y-8">
            <!-- Project Details -->
            <div class="glass rounded-2xl p-6 border border-white/10">
              <h3 class="text-xl font-bold text-white mb-6">
                Detalles del Proyecto
              </h3>
              <div class="space-y-4">
                <div>
                  <div class="text-gray-400 text-sm mb-1">Estado</div>
                  <div
                    class={`inline-flex px-3 py-1 rounded-full text-sm font-medium ${
                      status === "Completado"
                        ? "bg-green-500/20 text-green-400"
                        : "bg-yellow-500/20 text-yellow-400"
                    }`}
                  >
                    {status}
                  </div>
                </div>
                <div>
                  <div class="text-gray-400 text-sm mb-1">Duración</div>
                  <div class="text-white font-medium">{duration}</div>
                </div>
                <div>
                  <div class="text-gray-400 text-sm mb-1">Categoría</div>
                  <div class="text-white font-medium">{category}</div>
                </div>
              </div>
            </div>

            <!-- Gallery -->
            {
              gallery.length > 0 && (
                <div class="glass rounded-2xl p-6 border border-white/10">
                  <h3 class="text-xl font-bold text-white mb-6">Galería</h3>
                  <div class="grid grid-cols-1 gap-4">
                    {gallery.map((imageUrl, index) => (
                      <img
                        src={imageUrl}
                        alt={`${title} - Imagen ${index + 1}`}
                        class="w-full h-32 object-cover rounded-xl hover:scale-105 transition-transform duration-300 cursor-pointer gallery-image"
                        data-image-url={imageUrl}
                      />
                    ))}
                  </div>
                </div>
              )
            }

            <!-- Contact CTA -->
            <div
              class="glass rounded-2xl p-6 border border-green-500/20 text-center"
            >
              <h3 class="text-lg font-bold text-white mb-3">
                ¿Te interesa un proyecto similar?
              </h3>
              <p class="text-gray-400 text-sm mb-6">
                Hablemos sobre cómo puedo ayudarte con tu próximo proyecto
              </p>
              <a
                href="/#contact"
                class="w-full inline-flex items-center justify-center gap-2 bg-gradient-to-r from-green-600 to-green-500 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg hover:shadow-green-500/25 transition-all duration-300 hover:-translate-y-1 no-underline"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.13 8.13 0 01-2.939-.515l-5.637 1.406c-.365.092-.657-.215-.565-.565l1.406-5.637A8.13 8.13 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"
                  ></path>
                </svg>
                Conversemos
              </a>
            </div>
          </div>
        </div>
      </section>
    </main>

    <Footer />

    <!-- Image Modal for Gallery -->
    <div
      id="imageModal"
      class="fixed inset-0 bg-black/90 backdrop-blur-md z-50 hidden items-center justify-center p-4"
    >
      <div class="relative max-w-5xl max-h-full">
        <img
          id="modalImage"
          src=""
          alt=""
          class="max-w-full max-h-full object-contain rounded-xl"
        />
        <button
          id="closeModalBtn"
          class="absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center text-white backdrop-blur-sm transition-all duration-300"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>

    <script>
      // Image modal functionality
      function openImageModal(imageUrl: string): void {
        const modal = document.getElementById(
          "imageModal"
        ) as HTMLElement | null;
        const modalImage = document.getElementById(
          "modalImage"
        ) as HTMLImageElement | null;
        if (modal && modalImage) {
          modalImage.src = imageUrl;
          modal.classList.remove("hidden");
          modal.classList.add("flex");
          document.body.style.overflow = "hidden";
        }
      }

      function closeImageModal(): void {
        const modal = document.getElementById(
          "imageModal"
        ) as HTMLElement | null;
        if (modal) {
          modal.classList.add("hidden");
          modal.classList.remove("flex");
          document.body.style.overflow = "auto";
        }
      }

      // Event listeners setup
      document.addEventListener("DOMContentLoaded", () => {
        // Gallery images click handlers
        const galleryImages = document.querySelectorAll(
          ".gallery-image"
        ) as NodeListOf<HTMLImageElement>;
        galleryImages.forEach((img: HTMLImageElement) => {
          img.addEventListener("click", () => {
            const imageUrl = img.getAttribute("data-image-url");
            if (imageUrl) {
              openImageModal(imageUrl);
            }
          });
        });

        // Close modal button
        const closeBtn = document.getElementById(
          "closeModalBtn"
        ) as HTMLButtonElement | null;
        if (closeBtn) {
          closeBtn.addEventListener("click", closeImageModal);
        }

        // Close modal on click outside
        const modal = document.getElementById(
          "imageModal"
        ) as HTMLElement | null;
        if (modal) {
          modal.addEventListener("click", (e: MouseEvent) => {
            if (e.target === modal) {
              closeImageModal();
            }
          });
        }

        // Close modal on escape key
        document.addEventListener("keydown", (e: KeyboardEvent) => {
          if (e.key === "Escape") {
            closeImageModal();
          }
        });

        // Smooth scroll for anchor links
        const anchorLinks = document.querySelectorAll(
          'a[href^="#"]'
        ) as NodeListOf<HTMLAnchorElement>;
        anchorLinks.forEach((anchor: HTMLAnchorElement) => {
          anchor.addEventListener(
            "click",
            function (this: HTMLAnchorElement, e: MouseEvent) {
              e.preventDefault();
              const href = this.getAttribute("href");
              if (href) {
                const target = document.querySelector(
                  href
                ) as HTMLElement | null;
                if (target) {
                  target.scrollIntoView({
                    behavior: "smooth",
                    block: "start",
                  });
                }
              }
            }
          );
        });
      });
    </script>

    <style>
      /* Animaciones de entrada */
      .glass {
        opacity: 0;
        transform: translateY(20px);
        animation: slideInUp 0.6s ease-out forwards;
      }

      .glass:nth-child(1) {
        animation-delay: 0.1s;
      }
      .glass:nth-child(2) {
        animation-delay: 0.2s;
      }
      .glass:nth-child(3) {
        animation-delay: 0.3s;
      }
      .glass:nth-child(4) {
        animation-delay: 0.4s;
      }

      @keyframes slideInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Image modal */
      #imageModal {
        animation: fadeIn 0.3s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* Gallery hover effects */
      .gallery-image {
        transition:
          transform 0.3s ease,
          box-shadow 0.3s ease;
      }

      .gallery-image:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(34, 197, 94, 0.3);
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .grid.lg\:grid-cols-3 {
          grid-template-columns: 1fr;
        }

        .grid.lg\:grid-cols-2 {
          grid-template-columns: 1fr;
        }

        h1 {
          font-size: 2.5rem;
        }
      }

      /* Mode-specific styles are inherited from global.css */
    </style>
  </body>
</html>
